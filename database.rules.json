{
    "rules": {
        "users": {
            "$uid": {
                ".read": "$uid === auth.uid",
                ".write": "$uid === auth.uid",
                "email": {
                    ".validate": "newData.isString() && newData.val().length <= 255"
                },
                "username": {
                    ".validate": "newData.isString() && newData.val().length <= 100"
                },
                "createdAt": {
                    ".validate": "newData.isString()"
                },
                "verifiedAt": {
                    ".validate": "newData.isString()"
                },
                "puntos": {
                    ".validate": "newData.isNumber() && newData.val() >= 0"
                },
                "addresses": {
                    "$addressId": {
                        ".validate": "newData.hasChildren(['fullName', 'phone', 'street', 'city', 'postalCode', 'province'])",
                        "fullName": {
                            ".validate": "newData.isString() && newData.val().length <= 100"
                        },
                        "phone": {
                            ".validate": "newData.isString() && newData.val().length <= 20"
                        },
                        "street": {
                            ".validate": "newData.isString() && newData.val().length <= 200"
                        },
                        "city": {
                            ".validate": "newData.isString() && newData.val().length <= 100"
                        },
                        "postalCode": {
                            ".validate": "newData.isString() && newData.val().length <= 10"
                        },
                        "province": {
                            ".validate": "newData.isString() && newData.val().length <= 100"
                        }
                    }
                },
                "orders": {
                    "$orderId": {
                        ".read": "$uid === auth.uid",
                        ".write": "$uid === auth.uid && (!data.exists() || auth.token.admin === true)",
                        "items": {
                            ".validate": "newData.exists()"
                        },
                        "total": {
                            ".validate": "newData.isNumber() && newData.val() >= 0"
                        },
                        "status": {
                            ".validate": "newData.isString() && (newData.val() === 'pendiente' || newData.val() === 'procesando' || newData.val() === 'enviado' || newData.val() === 'entregado' || newData.val() === 'cancelado')",
                            ".write": "!data.exists() || auth.token.admin === true"
                        },
                        "tracking": {
                            ".write": "auth.token.admin === true"
                        },
                        "paymentConfirmed": {
                            ".write": "auth.token.admin === true"
                        }
                    }
                }
            }
        },
        "bestSellers": {
            ".read": true,
            ".write": "auth.token.admin === true"
        },
        "products": {
            ".read": true,
            ".write": "auth.token.admin === true"
        },
        "$other": {
            ".read": false,
            ".write": false
        }
    }
}